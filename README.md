# Laravel Media Package

**–í–µ—Ä—Å–∏—è:** 1.2.1  
**–õ–∏—Ü–µ–Ω–∑–∏—è:** MIT

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–µ–¥–∏–∞-—Ñ–∞–π–ª–∞–º–∏ –≤ Laravel –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö. –í–∫–ª—é—á–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–ø–∫–∞–º–∏, –∫–æ—Ä–∑–∏–Ω—É, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é, –ø–æ–∏—Å–∫ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ.

> üöÄ **–ù–æ–≤–æ–µ –≤ –≤–µ—Ä—Å–∏–∏ 1.2.1:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—É—Ç–∏ –∫ –∏–∫–æ–Ω–∫–∞–º –ø–∞–ø–æ–∫, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–æ—Ç–æ, —É–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –ø—É—Ç–µ–π!

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤–∏–¥–µ–æ, –¥–æ–∫—É–º–µ–Ω—Ç—ã)
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–ø–∫–∞–º–∏ —Å –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- ‚úÖ –ö–æ—Ä–∑–∏–Ω–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ü–∞–≥–∏–Ω–∞—Ü–∏—è
- ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
- ‚úÖ Drag & Drop –¥–ª—è –ø–∞–ø–æ–∫
- ‚úÖ Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- ‚úÖ RESTful API
- ‚úÖ –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –ø–∞–ø–∫–∏
- ‚úÖ –ú—É–ª—å—Ç–∏–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (scope –ø–æ user_id)
- ‚úÖ –ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–≤—å—é –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- PHP >= 8.2
- Laravel >= 10.0
- MySQL/MariaDB –∏–ª–∏ PostgreSQL

## –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ç–æ–ª—å–∫–æ API)

```bash
composer require letoceiling-coder/media
php artisan migrate
```

**–ì–æ—Ç–æ–≤–æ!** –ü–∞–∫–µ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –≤ [QUICK_START.md](QUICK_START.md)

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —à–∞–≥–∏ "–ü–æ–ª–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞" –Ω–∏–∂–µ!

### –ü–æ–ª–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Å Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏)

–°–º. –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é: [INSTALLATION_STEPS.md](INSTALLATION_STEPS.md)

**–ö—Ä–∞—Ç–∫–æ:**
1. `composer require letoceiling-coder/media`
2. `php artisan migrate`
3. `php artisan vendor:publish --tag=media-components`
4. `php artisan vendor:publish --tag=media-styles`
5. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ `@import '../css/vendor/media.css'` –≤ `app.css`
6. `npm install vue@^3.5.0 vue-router@^4.6.0 fslightbox-vue@^3.0.1 sweetalert2@^11.26.3`

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ Composer

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç –Ω–∞–ø—Ä—è–º—É—é:

```bash
composer require letoceiling-coder/media
```

–ö–æ–º–∞–Ω–¥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç–∞–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é –ø–∞–∫–µ—Ç–∞.

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ï—Å–ª–∏ –ø–∞–∫–µ—Ç –Ω–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –≤ Packagist, –¥–æ–±–∞–≤—å—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ `composer.json`:
> 
> ```json
> {
>     "repositories": [
>         {
>             "type": "vcs",
>             "url": "https://github.com/letoceiling-coder/media.git"
>         }
>     ]
> }
> ```
> 
> –ó–∞—Ç–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç: `composer require letoceiling-coder/media`

### 2. –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π

```bash
php artisan migrate
```

–ü–∞–∫–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª–∏—Ç –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç –Ω—É–∂–Ω—ã–π middleware (auth:sanctum –∏–ª–∏ auth:api)
- ‚úÖ –°–æ–∑–¥–∞—Å—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `public/upload` –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–æ—É—Ç—ã

### 3. –ü—É–±–ª–∏–∫–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ü—É–±–ª–∏–∫–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω—É–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏. –ü–∞–∫–µ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

```bash
php artisan vendor:publish --provider="LetoceilingCoder\Media\MediaServiceProvider" --tag="media-config"
```

### 4. –ü—É–±–ª–∏–∫–∞—Ü–∏—è Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
php artisan vendor:publish --tag=media-components
```

–≠—Ç–æ –æ–ø—É–±–ª–∏–∫—É–µ—Ç:
- `resources/js/vendor/media/components/Media.vue` - –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–µ–¥–∏–∞-–º–µ–Ω–µ–¥–∂–µ—Ä
- `resources/js/vendor/media/utils/api.js` - —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
- `resources/js/vendor/media/composables/useAuthToken.js` - composable –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### 5. –ü—É–±–ª–∏–∫–∞—Ü–∏—è CSS —Å—Ç–∏–ª–µ–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)

**–í–ê–ñ–ù–û:** –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å CSS —Å—Ç–∏–ª–∏:

```bash
php artisan vendor:publish --tag=media-styles
```

–ó–∞—Ç–µ–º –ø–æ–¥–∫–ª—é—á–∏—Ç–µ —Å—Ç–∏–ª–∏ –≤ –≤–∞—à–µ–º –≥–ª–∞–≤–Ω–æ–º CSS —Ñ–∞–π–ª–µ (`resources/css/app.css`):

```css
@import '../css/vendor/media.css';
```

–ò–ª–∏ –≤ `app.js`:

```javascript
import '../css/vendor/media.css'
```

### 6. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```bash
npm install vue@^3.5.0 vue-router@^4.6.0 fslightbox-vue@^3.0.1 sweetalert2@^11.26.3
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–º. [VUE_COMPONENTS.md](VUE_COMPONENTS.md)

### 7. –ü—É–±–ª–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–∏–∫–æ–Ω–∫–∏ –ø–∞–ø–æ–∫, —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è) (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
php artisan vendor:publish --tag=media-assets
```

–≠—Ç–æ –æ–ø—É–±–ª–∏–∫—É–µ—Ç –∏–∫–æ–Ω–∫–∏ –ø–∞–ø–æ–∫ –≤ `public/img/system/media/` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ.

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ü–∞–∫–µ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç "–∏–∑ –∫–æ—Ä–æ–±–∫–∏" –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏. –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–º–µ—é—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ middleware

–ü–∞–∫–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–æ–π middleware –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- –ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Laravel Sanctum ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `auth:sanctum`
- –ï—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω `auth.guards.api` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `auth:api`
- –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–ª–∏ `.env`

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ (`public/upload`) —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞ –∏–ª–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ ServiceProvider.

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –º–æ–∂–Ω–æ:

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, –±–µ–∑ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞):
   ```env
   MEDIA_MIDDLEWARE_API=auth:sanctum
   MEDIA_MAX_SIZE=10240
   MEDIA_UPLOAD_PATH=upload
   MEDIA_USER_SCOPING=true
   ```

2. **–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é**:
   ```bash
   php artisan vendor:publish --tag=media-config
   ```

–ü–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `config/media.php`:

```php
return [
    'upload' => [
        'max_size' => 10240, // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ KB (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10 MB)
        'allow_all_types' => false, // –†–∞–∑—Ä–µ—à–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤
        'allowed_mime_types' => [
            'image/jpeg',
            'image/png',
            'image/gif',
            'image/webp',
            'image/svg+xml',
            'video/mp4',
            // ...
        ],
        'path' => 'upload', // –ü—É—Ç—å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
    ],
    
    'pagination' => [
        'per_page_default' => 20,
        'per_page_max' => 100,
    ],
    
    'user_scoping' => true, // –í–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ user_id

    'middleware' => [
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ
        // null = –∞–≤—Ç–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, 'auth:sanctum' = —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å
        'api' => env('MEDIA_MIDDLEWARE_API', null),
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ middleware
        'additional' => env('MEDIA_MIDDLEWARE_ADDITIONAL', '') 
            ? explode(',', env('MEDIA_MIDDLEWARE_ADDITIONAL', '')) 
            : [],
    ],

    'auto_setup' => [
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
        'create_upload_directory' => env('MEDIA_AUTO_CREATE_UPLOAD_DIR', true),
    ],
];
```

–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `.env`:

```env
MEDIA_MAX_SIZE=10240
MEDIA_ALLOW_ALL_TYPES=false
MEDIA_UPLOAD_PATH=upload
MEDIA_PER_PAGE_DEFAULT=20
MEDIA_PER_PAGE_MAX=100
MEDIA_USER_SCOPING=true
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### API Endpoints

–ü–∞–∫–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ä–æ—É—Ç—ã:

#### Folders

- `GET /api/v1/folders` - –°–ø–∏—Å–æ–∫ –ø–∞–ø–æ–∫
- `POST /api/v1/folders` - –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É
- `GET /api/v1/folders/{id}` - –ü–æ–∫–∞–∑–∞—Ç—å –ø–∞–ø–∫—É
- `PUT /api/v1/folders/{id}` - –û–±–Ω–æ–≤–∏—Ç—å –ø–∞–ø–∫—É
- `DELETE /api/v1/folders/{id}` - –£–¥–∞–ª–∏—Ç—å –ø–∞–ø–∫—É (–ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É)
- `POST /api/v1/folders/{id}/restore` - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–ø–∫—É –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
- `GET /api/v1/folders/tree/all` - –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ä–µ–≤–æ –≤—Å–µ—Ö –ø–∞–ø–æ–∫
- `POST /api/v1/folders/update-positions` - –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏–∏ –ø–∞–ø–æ–∫

#### Media

- `GET /api/v1/media` - –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
- `POST /api/v1/media` - –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª
- `GET /api/v1/media/{id}` - –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–∞–π–ª
- `PUT /api/v1/media/{id}` - –û–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª (–ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –¥—Ä—É–≥—É—é –ø–∞–ø–∫—É –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å —Ñ–∞–π–ª)
- `DELETE /api/v1/media/{id}` - –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª (–ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É)
- `POST /api/v1/media/{id}/restore` - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
- `DELETE /api/v1/media/trash/empty` - –û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

#### –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞

```javascript
const formData = new FormData();
formData.append('file', fileInput.files[0]);
formData.append('folder_id', folderId); // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ

fetch('/api/v1/media', {
    method: 'POST',
    headers: {
        'Authorization': 'Bearer ' + token
    },
    body: formData
})
.then(response => response.json())
.then(data => console.log(data));
```

#### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π

```javascript
// –ü–æ–ª—É—á–∏—Ç—å —Ñ–∞–π–ª—ã –∏–∑ –ø–∞–ø–∫–∏
fetch('/api/v1/media?folder_id=1&per_page=20&page=1&sort_by=created_at&sort_order=desc')
    .then(response => response.json())
    .then(data => console.log(data));

// –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤
fetch('/api/v1/media?search=photo&type=photo')
    .then(response => response.json())
    .then(data => console.log(data));
```

#### –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–∫–∏

```javascript
fetch('/api/v1/folders', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer ' + token
    },
    body: JSON.stringify({
        name: '–ù–æ–≤–∞—è –ø–∞–ø–∫–∞',
        parent_id: null // null –¥–ª—è –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏
    })
})
.then(response => response.json())
.then(data => console.log(data));
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –≤ –∫–æ–¥–µ

```php
use LetoceilingCoder\Media\Models\Media;
use LetoceilingCoder\Media\Models\Folder;

// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
$media = Media::all();

// –ü–æ–ª—É—á–∏—Ç—å —Ñ–∞–π–ª—ã –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–∞–ø–∫–∏
$folder = Folder::find(1);
$files = $folder->files;

// –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É
$folder = Folder::create([
    'name' => '–ú–æ–∏ —Ñ–∞–π–ª—ã',
    'parent_id' => null
]);

// –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª (–æ–±—ã—á–Ω–æ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä)
$media = Media::create([
    'name' => 'filename.jpg',
    'original_name' => 'original.jpg',
    'extension' => 'jpg',
    'type' => 'photo',
    'size' => 1024000,
    'folder_id' => $folder->id,
    // ...
]);
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

–ü–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –µ–≥–æ –≤ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

```vue
<template>
    <Media 
        v-if="showMediaManager"
        :selection-mode="false"
        :count-file="1"
        @file-selected="handleFileSelected"
    />
</template>

<script setup>
import Media from '@/vendor/media/Media.vue'

const showMediaManager = ref(true)

const handleFileSelected = (file) => {
    console.log('–í—ã–±—Ä–∞–Ω —Ñ–∞–π–ª:', file)
}
</script>
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `folders`

- `id` - ID –ø–∞–ø–∫–∏
- `name` - –ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏
- `slug` - URL-—Å–ª–∞–≥
- `src` - –ò–∫–æ–Ω–∫–∞ –ø–∞–ø–∫–∏
- `parent_id` - ID —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –ø–∞–ø–∫–∏
- `position` - –ü–æ–∑–∏—Ü–∏—è –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
- `protected` - –ó–∞—â–∏—â–µ–Ω–∞ –ª–∏ –ø–∞–ø–∫–∞ –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è
- `is_trash` - –Ø–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–∞–ø–∫–∞ –∫–æ—Ä–∑–∏–Ω–æ–π
- `user_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–ª—è –º—É–ª—å—Ç–∏–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞)
- `created_at`, `updated_at`, `deleted_at`

### –¢–∞–±–ª–∏—Ü–∞ `media`

- `id` - ID —Ñ–∞–π–ª–∞
- `name` - –ò–º—è —Ñ–∞–π–ª–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- `original_name` - –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞
- `extension` - –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
- `disk` - –î–∏—Å–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
- `width` - –®–∏—Ä–∏–Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–¥–ª—è —Ñ–æ—Ç–æ)
- `height` - –í—ã—Å–æ—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–¥–ª—è —Ñ–æ—Ç–æ)
- `type` - –¢–∏–ø —Ñ–∞–π–ª–∞ (photo, video, document)
- `size` - –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –±–∞–π—Ç–∞—Ö
- `folder_id` - ID –ø–∞–ø–∫–∏
- `original_folder_id` - ID –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–∏ (–¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã)
- `user_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `telegram_file_id` - ID —Ñ–∞–π–ª–∞ –≤ Telegram (–µ—Å–ª–∏ –±—ã–ª –∑–∞–≥—Ä—É–∂–µ–Ω –æ—Ç—Ç—É–¥–∞)
- `metadata` - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (JSON)
- `temporary` - –í—Ä–µ–º–µ–Ω–Ω—ã–π –ª–∏ —Ñ–∞–π–ª
- `created_at`, `updated_at`, `deleted_at`

## –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é API –Ω–µ –∑–∞—â–∏—â–µ–Ω–æ middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –î–ª—è –∑–∞—â–∏—Ç—ã –¥–æ–±–∞–≤—å—Ç–µ middleware –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –∏–ª–∏ —á–µ—Ä–µ–∑ `MediaServiceProvider`:

```php
// –í MediaServiceProvider::boot()
Route::prefix('api/v1')
    ->middleware(['api', 'auth:sanctum']) // –î–æ–±–∞–≤—å—Ç–µ middleware
    ->group(function () {
        // —Ä–æ—É—Ç—ã...
    });
```

## –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

–ü–∞–∫–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ `user_id` —á–µ—Ä–µ–∑ scope. –≠—Ç–æ –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:

```php
'user_scoping' => true // –∏–ª–∏ false –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
```

–ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏
- –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞–ø–∫–∏ (—Å `user_id = NULL`) –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º
- –ö–æ—Ä–∑–∏–Ω–∞ –æ–±—â–∞—è –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–î–ª—è –æ–±—Ö–æ–¥–∞ scope –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```php
// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ user_id
$allMedia = Media::withoutUserScope()->get();

// –ü–æ–ª—É—á–∏—Ç—å —Ñ–∞–π–ª—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
$userMedia = Media::forUser($userId)->get();

// –ü–æ–ª—É—á–∏—Ç—å —Ñ–∞–π–ª—ã –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
$allUsersMedia = Media::allUsers()->get();
```

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤

–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π —Ñ–∏–ª—å—Ç—Ä:

```php
namespace App\Http\Filters;

use LetoceilingCoder\Media\Http\Filters\AbstractFilter;
use Illuminate\Database\Eloquent\Builder;

class MediaFilter extends AbstractFilter
{
    public const TYPE = 'type';
    
    protected function getCallbacks(): array
    {
        return [
            self::TYPE => [$this, 'type'],
        ];
    }
    
    public function type(Builder $builder, $value)
    {
        $builder->where('type', $value);
    }
}
```

### –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π, —Å–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–∏ –º–æ–¥–µ–ª–∏, –Ω–∞—Å–ª–µ–¥—É—è –æ—Ç –º–æ–¥–µ–ª–µ–π –ø–∞–∫–µ—Ç–∞:

```php
namespace App\Models;

use LetoceilingCoder\Media\Models\Media as BaseMedia;

class Media extends BaseMedia
{
    // –í–∞—à–∞ –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è
}
```

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —Å–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏: https://github.com/letoceiling-coder/media

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

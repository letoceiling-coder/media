# Версионирование пакета

## Как работает версионирование

Пакет использует [Semantic Versioning](https://semver.org/) (SemVer) для управления версиями.

**Важно:** Версии пакета управляются через Git теги, а НЕ через поле `version` в `composer.json`. Packagist автоматически определяет версию на основе Git тегов.

## Формат версий

Версии следуют формату: `MAJOR.MINOR.PATCH`

- **MAJOR** - несовместимые изменения API
- **MINOR** - новая функциональность с обратной совместимостью
- **PATCH** - исправления ошибок с обратной совместимостью

## Процесс создания новой версии

### 1. Внесите изменения в код

Сделайте необходимые изменения и закоммитьте их:

```bash
git add .
git commit -m "Описание изменений"
git push origin main
```

### 2. Обновите CHANGELOG.md

Добавьте новую секцию с версией и описанием изменений в начало файла `CHANGELOG.md`:

```markdown
## [1.2.2] - 2025-12-07

### Исправлено
- Исправлена ошибка X
- Улучшена производительность Y

### Добавлено
- Новая функция Z
```

### 3. Создайте Git тег

Создайте тег с версией (формат: `vX.Y.Z`):

```bash
git tag v1.2.2 -m "Version 1.2.2: Описание изменений"
```

### 4. Отправьте тег в GitHub

```bash
git push origin v1.2.2
```

Также убедитесь, что все коммиты отправлены:

```bash
git push origin main
```

### 5. Обновите Packagist

После отправки тега Packagist автоматически обновится в течение нескольких минут. Если не обновился автоматически:

1. Зайдите на https://packagist.org/packages/letoceiling-coder/media
2. Нажмите кнопку "Update" (Обновить)

## Текущие версии

- **v1.2.1** - Исправления путей к иконкам и обработчика редактирования
- **v1.2.0** - Добавлены Vue компоненты и утилиты
- **v1.1.0** - Автоматическая настройка middleware и директорий
- **v1.0.0** - Первый стабильный релиз

## Проверка текущей версии

Посмотреть все теги:

```bash
git tag --sort=-v:refname
```

Посмотреть последний тег:

```bash
git describe --tags --abbrev=0
```

## Автоматизация (опционально)

Можно создать скрипт для автоматизации процесса:

```bash
#!/bin/bash
# release.sh

VERSION=$1
if [ -z "$VERSION" ]; then
    echo "Использование: ./release.sh 1.2.2"
    exit 1
fi

# Обновить CHANGELOG (вручную)
echo "Обновите CHANGELOG.md и нажмите Enter..."
read

# Создать и отправить тег
git tag v$VERSION -m "Version $VERSION"
git push origin v$VERSION
git push origin main

echo "Версия v$VERSION создана и отправлена!"
```

## Важные замечания

1. **Всегда используйте формат `vX.Y.Z`** для тегов (с префиксом `v`)
2. **Никогда не удаляйте теги** после публикации на Packagist
3. **Обновляйте CHANGELOG.md** перед созданием новой версии
4. **Тестируйте изменения** перед созданием релиза
5. **Не используйте поле `version` в composer.json** - Packagist игнорирует его

## Источники

- [Semantic Versioning](https://semver.org/)
- [Packagist Documentation](https://packagist.org/about)
- [Git Tagging](https://git-scm.com/book/en/v2/Git-Basics-Tagging)

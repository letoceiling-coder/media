# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–ü–∞–∫–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã "–∏–∑ –∫–æ—Ä–æ–±–∫–∏" —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ (3 —à–∞–≥–∞)

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç

```bash
composer require letoceiling-coder/media
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
php artisan migrate
```

### 3. –ì–æ—Ç–æ–≤–æ! üéâ

–ü–∞–∫–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª–∏—Ç –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç –Ω—É–∂–Ω—ã–π middleware (auth:sanctum –∏–ª–∏ auth:api)
- ‚úÖ –°–æ–∑–¥–∞—Å—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `public/upload` –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–æ—É—Ç—ã
- ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

## –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ middleware

–ü–∞–∫–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–æ–π middleware –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- –ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Laravel Sanctum ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `auth:sanctum`
- –ï—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω `auth.guards.api` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `auth:api`
- –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí —Ä–æ—É—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –¥–æ–±–∞–≤—å—Ç–µ –≤ `.env`:

```env
# Middleware (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)
MEDIA_MIDDLEWARE_API=auth:sanctum
# –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é: MEDIA_MIDDLEWARE_ADDITIONAL=throttle:60,1

# –†–∞–∑–º–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
MEDIA_MAX_SIZE=10240

# –ü—É—Ç—å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
MEDIA_UPLOAD_PATH=upload

# –ü–∞–≥–∏–Ω–∞—Ü–∏—è
MEDIA_PER_PAGE_DEFAULT=20
MEDIA_PER_PAGE_MAX=100

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
MEDIA_USER_SCOPING=true

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å)
MEDIA_AUTO_CREATE_UPLOAD_DIR=true
MEDIA_AUTO_PUBLISH_CONFIG=true
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API

–í—Å–µ —Ä–æ—É—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –∞–¥—Ä–µ—Å—É `/api/v1/`:

```javascript
// –ü–æ–ª—É—á–∏—Ç—å –ø–∞–ø–∫–∏
GET /api/v1/folders

// –ü–æ–ª—É—á–∏—Ç—å —Ñ–∞–π–ª—ã
GET /api/v1/media

// –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª
POST /api/v1/media
FormData: { file: File, folder_id?: number }
```

## –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

### –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ middleware —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

–û–ø—É–±–ª–∏–∫—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–Ω–æ):

```bash
php artisan vendor:publish --tag=media-config
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `config/media.php`:

```php
'middleware' => [
    'api' => 'auth:sanctum', // –∏–ª–∏ –º–∞—Å—Å–∏–≤ ['auth:sanctum', 'throttle:60']
    'additional' => [], // –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ middleware
],
```

### –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

–í `.env`:

```env
MEDIA_AUTO_CREATE_UPLOAD_DIR=false
MEDIA_AUTO_PUBLISH_CONFIG=false
```

## –ü—Ä–æ–±–ª–µ–º—ã?

### –ü–∞–∫–µ—Ç –Ω–µ –ø–æ–¥—Ö–≤–∞—Ç–∏–ª middleware

–ï—Å–ª–∏ middleware –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–∏–ª—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –¥–æ–±–∞–≤—å—Ç–µ –≤ `config/media.php`:

```php
'middleware' => [
    'api' => 'auth:sanctum', // —è–≤–Ω–æ —É–∫–∞–∂–∏—Ç–µ middleware
],
```

### –§–∞–π–ª—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é: `chmod -R 755 public/upload`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: `config/media.php` ‚Üí `upload.path`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: `config/media.php` ‚Üí `upload.max_size`

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

- –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –ø–æ–ª–Ω—É—é [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é](README.md)
- –ò–∑—É—á–∏—Ç–µ [–ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](README.md#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
